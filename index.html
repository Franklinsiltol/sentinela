<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentinela - Análise Inteligente de Conversas</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Estilos mantidos do código anterior */
        :root {
            --primary-color: #000000;
            --secondary-color: #FFFFFF;
            --accent-color: #4CAF50;
            --warning-color: #FFC107;
            --danger-color: #F44336;
            --info-color: #2196F3;
            --light-gray: #f5f7fa;
            --medium-gray: #e4e7ed;
            --dark-gray: #333333;
            --sidebar-width: 300px;
            --header-height: 70px;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-gray);
            color: var(--primary-color);
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Header */
        .header {
            height: var(--header-height);
            background-color: var(--secondary-color);
            box-shadow: var(--box-shadow);
            display: flex;
            align-items: center;
            padding: 0 20px;
            position: fixed;
            top: 0;
            left: var(--sidebar-width);
            right: 0;
            z-index: 100;
            transition: var(--transition);
        }

        .header.collapsed {
            left: 70px;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .header-actions {
            margin-left: auto;
            display: flex;
            gap: 15px;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--secondary-color);
            box-shadow: var(--box-shadow);
            padding: 20px;
            overflow-y: auto;
            position: fixed;
            height: 100vh;
            z-index: 100;
            transition: var(--transition);
        }

        .sidebar.collapsed {
            width: 70px;
            overflow: hidden;
        }

        .sidebar.collapsed .sidebar-content {
            opacity: 0;
            pointer-events: none;
        }

        .sidebar-toggle {
            position: absolute;
            top: 20px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--primary-color);
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--medium-gray);
        }

        .logo-icon {
            font-size: 2rem;
            margin-right: 10px;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .sidebar.collapsed .logo-text {
            display: none;
        }

        .main-content {
            margin-left: var(--sidebar-width);
            padding: 90px 20px 20px 20px;
            width: calc(100% - var(--sidebar-width));
            transition: var(--transition);
        }

        .main-content.expanded {
            margin-left: 70px;
            width: calc(100% - 70px);
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            font-weight: bold;
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            font-size: 1.2rem;
        }

        .sidebar.collapsed .section-title span {
            display: none;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .input-group input,
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--medium-gray);
            border-radius: var(--border-radius);
            background-color: var(--secondary-color);
            color: var(--primary-color);
            transition: var(--transition);
        }

        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }

        .input-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .button {
            background-color: var(--primary-color);
            color: var(--secondary-color);
            border: 2px solid var(--primary-color);
            padding: 10px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .button:hover {
            background-color: var(--dark-gray);
            border-color: var(--dark-gray);
        }

        .button-primary {
            background-color: var(--primary-color);
            color: var(--secondary-color);
        }

        .button-secondary {
            background-color: transparent;
            color: var(--primary-color);
        }

        .button-success {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }

        .button-warning {
            background-color: var(--warning-color);
            border-color: var(--warning-color);
            color: black;
        }

        .button-danger {
            background-color: var(--danger-color);
            border-color: var(--danger-color);
            color: white;
        }

        .button-info {
            background-color: var(--info-color);
            border-color: var(--info-color);
            color: white;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-success {
            background-color: var(--accent-color);
        }

        .status-error {
            background-color: var(--danger-color);
        }

        .status-warning {
            background-color: var(--warning-color);
        }

        /* Dashboard */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .dashboard-title {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .dashboard-actions {
            display: flex;
            gap: 10px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background-color: var(--secondary-color);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            position: relative;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .metric-icon {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--dark-gray);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .metric-trend {
            display: flex;
            align-items: center;
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .trend-up {
            color: var(--accent-color);
        }

        .trend-down {
            color: var(--danger-color);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--medium-gray);
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab:hover {
            background-color: var(--light-gray);
        }

        .tab.active {
            border-bottom: 3px solid var(--primary-color);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background-color: var(--secondary-color);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
        }

        .chart-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Loading */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 50vh;
            text-align: center;
        }

        .spinner {
            border: 3px solid var(--medium-gray);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Alertas */
        .alert {
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert i {
            font-size: 1.2rem;
        }

        .alert-info {
            background-color: #e3f2fd;
            border-left: 4px solid var(--info-color);
        }

        .alert-warning {
            background-color: #fff3cd;
            border-left: 4px solid var(--warning-color);
        }

        .alert-success {
            background-color: #e8f5e9;
            border-left: 4px solid var(--accent-color);
        }

        .alert-error {
            background-color: #ffebee;
            border-left: 4px solid var(--danger-color);
        }

        /* Progress bars */
        .progress-bar {
            height: 8px;
            background-color: var(--medium-gray);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--accent-color);
            border-radius: 4px;
        }

        /* Cards */
        .card {
            background-color: var(--secondary-color);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: bold;
        }

        /* Forms */
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
        }

        /* Tables */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--medium-gray);
        }

        .data-table th {
            background-color: var(--light-gray);
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: var(--light-gray);
        }

        /* Chat bubbles */
        .chat-container {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            background-color: var(--light-gray);
            border-radius: var(--border-radius);
        }

        .chat-agent {
            background-color: var(--secondary-color);
            padding: 12px 15px;
            border-radius: 18px 18px 18px 0;
            margin: 8px 0;
            border-left: 4px solid var(--accent-color);
            max-width: 80%;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .chat-client {
            background-color: #e3f2fd;
            padding: 12px 15px;
            border-radius: 18px 18px 0 18px;
            margin: 8px 0 8px auto;
            border-left: 4px solid var(--info-color);
            max-width: 80%;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .chat-sender {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--secondary-color);
            border-radius: var(--border-radius);
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark-gray);
        }

        /* Utilities */
        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .mb-0 {
            margin-bottom: 0;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .hidden {
            display: none !important;
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                transform: translateX(-100%);
                z-index: 1000;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
                width: 100%;
                padding: 70px 15px 15px 15px;
            }
            
            .header {
                left: 0;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                flex-direction: column;
                gap: 10px;
            }
        }

        @media (max-width: 576px) {
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .dashboard-actions {
                width: 100%;
                justify-content: space-between;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --primary-color: #FFFFFF;
                --secondary-color: #1a1a1a;
                --light-gray: #2d2d2d;
                --medium-gray: #3d3d3d;
                --dark-gray: #cccccc;
            }
        }

        /* Estilos para análise de palavras */
        .word-cloud-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            padding: 20px;
            min-height: 300px;
            align-items: center;
        }
        
        .word-item {
            padding: 4px 8px;
            border-radius: 12px;
            display: inline-block;
            margin: 2px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .word-item:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .search-result-item {
            background: var(--light-gray);
            padding: 15px;
            margin: 10px 0;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--info-color);
        }
        
        .search-highlight {
            background-color: yellow;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .phrase-analysis {
            margin-top: 20px;
        }
        
        .stop-words-list {
            max-height: 200px;
            overflow-y: auto;
            background: var(--light-gray);
            padding: 10px;
            border-radius: var(--border-radius);
            margin-top: 10px;
        }
        
        .stop-word-item {
            display: inline-block;
            background: var(--medium-gray);
            padding: 4px 8px;
            margin: 2px;
            border-radius: 12px;
            font-size: 0.8rem;
            position: relative;
        }

        .remove-stop-word {
            background: none;
            border: none;
            color: var(--danger-color);
            cursor: pointer;
            margin-left: 5px;
            font-size: 0.7rem;
            padding: 2px;
        }

        .remove-stop-word:hover {
            color: var(--warning-color);
        }

        /* Estilos para IA Avançada */
        .insight-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin: 15px 0;
            box-shadow: var(--box-shadow);
        }
        
        .insight-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .insight-icon {
            font-size: 1.5rem;
        }
        
        .insight-content {
            line-height: 1.6;
        }
        
        .model-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-radius: var(--border-radius);
            margin: 10px 0;
        }
        
        .status-loading {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        
        .status-ready {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
        }
        
        .status-error {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        
        .analysis-progress {
            width: 100%;
            height: 8px;
            background-color: var(--medium-gray);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            transition: width 0.3s ease;
        }
        
        .topic-item {
           background: var(--light-gray);
    padding: 12px;
    margin: 8px 0;
    border-radius: var(--border-radius);
    border-left: 4px solid var(--info-color);
    color: var(--primary-color); 
        }
        
        .confidence-badge {
            background: var(--accent-color);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 10px;
        }
        
        .sentiment-distribution {
            display: flex;
            gap: 5px;
            margin: 10px 0;
        }
        
        .sentiment-bar {
            flex: 1;
            height: 8px;
            border-radius: 4px;
        }
        
        .recommendation-item {
            padding: 12px;
    margin: 8px 0;
    background: var(--light-gray);
    border-radius: var(--border-radius);
    border-left: 4px solid var(--warning-color);
    color: var(--primary-color);
        }

        /* Estilos para análise de áudio */
        .audio-controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .audio-visualizer {
            width: 100%;
            height: 100px;
            background: var(--light-gray);
            border-radius: var(--border-radius);
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }
        
        .visualizer-bar {
            position: absolute;
            bottom: 0;
            width: 4px;
            background: var(--accent-color);
            margin: 0 1px;
        }
        
        .recording-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #ffebee;
            border-radius: var(--border-radius);
            margin: 10px 0;
        }
        
        .pulse {
            width: 12px;
            height: 12px;
            background: #f44336;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(0.95); opacity: 0.7; }
        }
        
        .transcription-result {
            background: var(--light-gray);
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 15px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .transcription-line {
            padding: 8px;
            margin: 5px 0;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .transcription-line:hover {
            background: var(--medium-gray);
            border-left-color: var(--info-color);
        }
        
        .speaker-label {
            font-weight: bold;
            color: var(--info-color);
            margin-right: 8px;
        }
        
        .audio-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .audio-metric {
            text-align: center;
            padding: 15px;
            background: var(--light-gray);
            border-radius: var(--border-radius);
        }
        
        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 5px 0;
        }
        
        .waveform-container {
            width: 100%;
            height: 80px;
            background: var(--light-gray);
            border-radius: var(--border-radius);
            position: relative;
            overflow: hidden;
        }
        
        .audio-player-custom {
            width: 100%;
            margin: 10px 0;
        }

        .paste-transcription-container {
            background: var(--light-gray);
            padding: 15px;
            border-radius: var(--border-radius);
            margin: 15px 0;
        }

        /* Novos estilos para melhorias */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark-gray);
            color: var(--secondary-color);
            text-align: center;
            border-radius: var(--border-radius);
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            font-weight: normal;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 5px;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid var(--medium-gray);
            background: var(--secondary-color);
            cursor: pointer;
            border-radius: 4px;
        }

        .pagination button.active {
            background: var(--primary-color);
            color: var(--secondary-color);
        }

        .pagination button:hover:not(.active) {
            background: var(--light-gray);
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            flex-direction: column;
            color: white;
        }

        .loading-overlay .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
        }

        .validation-error {
            border-color: var(--danger-color) !important;
            box-shadow: 0 0 0 2px rgba(244, 67, 54, 0.2) !important;
        }

        .validation-message {
            color: var(--danger-color);
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .cache-indicator {
            background: var(--info-color);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 5px;
        }

        /* Estilos para as novas métricas */
        .metric-card:nth-child(6) { border-left: 4px solid #9C27B0; }
        .metric-card:nth-child(7) { border-left: 4px solid #FF9800; }
        .metric-card:nth-child(8) { border-left: 4px solid #2196F3; }

        .nps-positive { color: #4CAF50 !important; }
        .nps-negative { color: #F44336 !important; }

        .sidebar.collapsed #statsContainer {
            display: none;
        }

        /* Novos estilos para notificações */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            z-index: 10000;
            max-width: 400px;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-success {
            background-color: var(--accent-color);
            color: white;
        }

        .notification-info {
            background-color: var(--info-color);
            color: white;
        }

        .notification-warning {
            background-color: var(--warning-color);
            color: black;
        }

        .notification-error {
            background-color: var(--danger-color);
            color: white;
        }

        /* Exemplo com data e hora */
        .timestamp {
            font-size: 0.8rem;
            color: var(--dark-gray);
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="logo">
                <div class="logo-icon">🛡️</div>
                <div class="logo-text">Sentinela</div>
            </div>
            
            <div class="sidebar-content">
                <div class="section">
                    <h3 class="section-title">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </h3>
                    <div class="input-group">
                        <label>Data Inicial</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="input-group">
                        <label>Data Final</label>
                        <input type="date" id="endDate">
                    </div>
                    <button class="button button-primary" id="applyFilter">
                        <i class="fas fa-filter"></i>
                        <span>Aplicar Filtro</span>
                    </button>
                </div>
                
                <div class="section">
                    <h3 class="section-title">
                        <i class="fas fa-database"></i>
                        <span>Fontes de Dados</span>
                    </h3>
                    <div class="input-group">
                        <label>Upload de Arquivo</label>
                        <input type="file" id="fileUpload" accept=".csv,.xlsx,.xls">
                    </div>
                    <div class="input-group">
                        <label>ID da Planilha Google</label>
                        <input type="text" id="sheetId" placeholder="ID da planilha">
                    </div>
                    <div class="input-group">
                        <label>Nome da Aba</label>
                        <input type="text" id="sheetTab" placeholder="Nome da aba (ex: Página1)">
                    </div>
                    <button class="button button-primary" id="loadData">
                        <i class="fas fa-sync-alt"></i>
                        <span>Carregar Dados</span>
                    </button>
                </div>
                
                <div class="section">
                    <h3 class="section-title">
                        <i class="fas fa-chart-pie"></i>
                        <span>Estatísticas</span>
                    </h3>
                    <div id="statsContainer">
                        <div class="metric-card">
                            <div class="metric-label">
                                Total de Interações
                                <span class="tooltip">
                                    <i class="fas fa-question-circle"></i>
                                    <span class="tooltiptext">Número total de conversas únicas entre agentes e clientes</span>
                                </span>
                            </div>
                            <div class="metric-value" id="statInteractions">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">
                                Total de Mensagens
                                <span class="tooltip">
                                    <i class="fas fa-question-circle"></i>
                                    <span class="tooltiptext">Número total de mensagens trocadas em todas as conversas</span>
                                </span>
                            </div>
                            <div class="metric-value" id="statMessages">0</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">
                                Agentes Únicos
                                <span class="tooltip">
                                    <i class="fas fa-question-circle"></i>
                                    <span class="tooltiptext">Número de agentes diferentes que participaram das conversas</span>
                                </span>
                            </div>
                            <div class="metric-value" id="statAgents">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Header -->
        <div class="header" id="header">
            <div class="header-title">Painel de Análise</div>
            <div class="header-actions">
                <button class="button button-info" id="exportData">
                    <i class="fas fa-download"></i>
                    Exportar
                </button>
                <button class="button button-primary" id="refreshData">
                    <i class="fas fa-redo"></i>
                    Atualizar
                </button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <div id="loadingIndicator" class="loading">
                <div class="spinner"></div>
                <p>Carregando Sentinela...</p>
            </div>
            
            <div id="contentArea" class="hidden">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Bem-vindo ao Sentinela!</strong> Carregue seus dados para começar a análise.
                    </div>
                </div>
                
                <!-- Métricas Principais -->
                <div class="metrics-grid" id="metricsGrid">
                    <div class="metric-card">
                        <div class="metric-icon">🛡️</div>
                        <div class="metric-value" id="metricInteractions">0</div>
                        <div class="metric-label">
                            Interações
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Número total de conversas únicas entre agentes e clientes</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricInteractionsTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">💬</div>
                        <div class="metric-value" id="metricMessages">0</div>
                        <div class="metric-label">
                            Mensagens
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Número total de mensagens trocadas em todas as conversas</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricMessagesTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">✅</div>
                        <div class="metric-value" id="metricPositive">0</div>
                        <div class="metric-label">
                            Positivas
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Mensagens com sentimento positivo identificado</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricPositiveTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">⚠️</div>
                        <div class="metric-value" id="metricNegative">0</div>
                        <div class="metric-label">
                            Negativas
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Mensagens com sentimento negativo identificado</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricNegativeTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">🔍</div>
                        <div class="metric-value" id="metricProblems">0</div>
                        <div class="metric-label">
                            Problemas
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Problemas ou dificuldades identificados nas conversas</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricProblemsTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                    <!-- Novas Métricas -->
                    <div class="metric-card">
                        <div class="metric-icon">🎯</div>
                        <div class="metric-value" id="metricResolutionRate">0%</div>
                        <div class="metric-label">
                            Taxa de Resolução
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Percentual de problemas identificados que foram resolvidos<br>80%+: Excelente | 60-80%: Bom | &lt;60%: Melhorar</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricResolutionRateTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">⚡</div>
                        <div class="metric-value" id="metricEfficiency">0</div>
                        <div class="metric-label">
                            Eficiência
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Mensagens por interação (eficiência na comunicação)<br>2-4: Ideal | &gt;4: Muito longo | &lt;2: Muito curto</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricEfficiencyTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">😊</div>
                        <div class="metric-value" id="metricNPS">0</div>
                        <div class="metric-label">
                            NPS Estimado
                            <span class="tooltip">
                                <i class="fas fa-question-circle"></i>
                                <span class="tooltiptext">Pontuação baseada no sentimento (% Positivas - % Negativas) × 10<br>&gt;50: Excelente | 0-50: Bom | &lt;0: Crítico</span>
                            </span>
                        </div>
                        <div class="metric-trend" id="metricNPSTrend">
                            <i class="fas fa-minus"></i>
                            <span>Carregando...</span>
                        </div>
                    </div>
                </div>
                
                <!-- Abas -->
                <div class="tabs" id="mainTabs">
                    <div class="tab active" data-tab="overview">
                        <i class="fas fa-chart-bar"></i>
                        Visão Geral
                    </div>
                    <div class="tab" data-tab="agents">
                        <i class="fas fa-users"></i>
                        Agentes
                    </div>
                    <div class="tab" data-tab="trends">
                        <i class="fas fa-chart-line"></i>
                        Tendências
                    </div>
                    <div class="tab" data-tab="words">
                        <i class="fas fa-font"></i>
                        Análise de Texto
                    </div>
                    <div class="tab" data-tab="ai">
                        <i class="fas fa-robot"></i>
                        IA Avançada
                    </div>
                    <div class="tab" data-tab="audio">
                        <i class="fas fa-microphone"></i>
                        Análise de Áudio
                    </div>
                </div>
                
                <!-- Conteúdo das Abas -->
                <div id="tabContents">
                    <div class="tab-content active" id="overview">
                        <div class="charts-grid">
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-smile"></i>
                                    Distribuição de Sentimento
                                </div>
                                <div id="sentimentChart"></div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-users"></i>
                                    Agentes com Mais Atendimentos
                                </div>
                                <div id="agentsChart"></div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-chart-pie"></i>
                                    Análise de Conteúdo
                                </div>
                                <div id="contentChart"></div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-calendar-alt"></i>
                                    Evolução Temporal
                                </div>
                                <div id="temporalChart"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="agents">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Desempenho por Agente</div>
                                <button class="button button-info" id="exportAgents">
                                    <i class="fas fa-download"></i>
                                    Exportar Relatório
                                </button>
                            </div>
                            <div id="agentsTable"></div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="trends">
                        <div class="charts-grid">
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-chart-line"></i>
                                    Métricas ao Longo do Tempo
                                </div>
                                <div id="trendsChart"></div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-project-diagram"></i>
                                    Correlação entre Métricas
                                </div>
                                <div id="correlationChart"></div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Dados Diários</div>
                                <button class="button button-info" id="exportTrends">
                                    <i class="fas fa-download"></i>
                                    Exportar Dados
                                </button>
                            </div>
                            <div id="dailyTable"></div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="words">
                        <div class="charts-grid">
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-cloud"></i>
                                    Nuvem de Palavras
                                    <button class="button button-info" style="margin-left: auto; padding: 5px 10px; font-size: 0.8rem;" id="refreshWordCloud">
                                        <i class="fas fa-sync-alt"></i>
                                        Atualizar
                                    </button>
                                </div>
                                <div id="wordCloud" class="word-cloud-container"></div>
                            </div>
                            <div class="chart-container">
                                <div class="chart-title">
                                    <i class="fas fa-chart-bar"></i>
                                    Palavras Mais Frequentes
                                </div>
                                <div id="wordFrequencyChart"></div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Busca Avançada por Palavras</div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Buscar Palavra ou Frase</label>
                                    <input type="text" id="wordSearch" placeholder="Ex: cartão de crédito, problema técnico...">
                                </div>
                                <div class="form-group">
                                    <label>Filtrar por Sentimento</label>
                                    <select id="sentimentFilter">
                                        <option value="all">Todos</option>
                                        <option value="positive">Positivo</option>
                                        <option value="negative">Negativo</option>
                                        <option value="neutral">Neutro</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <button class="button button-primary" id="performSearch">
                                    <i class="fas fa-search"></i>
                                    Buscar
                                </button>
                                <button class="button button-secondary" id="clearSearch">
                                    <i class="fas fa-times"></i>
                                    Limpar
                                </button>
                                <button class="button button-info" id="batchStopWords" title="Adicionar múltiplas stop words">
                                    <i class="fas fa-bulk"></i>
                                    Adicionar Múltiplas
                                </button>
                            </div>
                            <div id="searchResults" class="mt-20"></div>
                            
                            <!-- Gráfico de Timeline para ocorrências por dia -->
                            <div class="chart-container mt-20">
                                <div class="chart-title">
                                    <i class="fas fa-chart-line"></i>
                                    Ocorrências ao Longo do Tempo
                                </div>
                                <div id="timelineChart"></div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Análise de Combinações de Palavras</div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Frase para Análise</label>
                                    <input type="text" id="phraseInput" placeholder="Ex: cartão de crédito, suporte técnico...">
                                </div>
                            </div>
                            <div class="form-row">
                                <button class="button button-primary" id="analyzePhrase">
                                    <i class="fas fa-chart-bar"></i>
                                    Analisar Frase
                                </button>
                            </div>
                            <div id="phraseAnalysis" class="phrase-analysis"></div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Gerenciar Stop Words</div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Adicionar Stop Word</label>
                                    <input type="text" id="newStopWord" placeholder="Digite uma palavra para adicionar...">
                                </div>
                            </div>
                            <div class="form-row">
                                <button class="button button-primary" id="addStopWord">
                                    <i class="fas fa-plus"></i>
                                    Adicionar
                                </button>
                                <button class="button button-secondary" id="resetStopWords">
                                    <i class="fas fa-undo"></i>
                                    Restaurar Padrão
                                </button>
                            </div>
                            <div class="stop-words-list" id="stopWordsList">
                                <!-- Stop words serão carregadas aqui -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="ai">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Análise com IA Avançada</div>
                                <div class="form-group" style="margin-bottom: 0;">
                                    <label class="switch">
                                        <input type="checkbox" id="advancedIAToggle">
                                        <span class="slider round"></span>
                                    </label>
                                    <span style="margin-left: 10px;">IA Avançada</span>
                                </div>
                            </div>
                            <div id="modelStatus" class="model-status status-ready">
                                <i class="fas fa-check-circle"></i>
                                <span>Análise de IA Básica Disponível</span>
                            </div>
                            
                            <div class="alert alert-info">
                                <i class="fas fa-robot"></i>
                                <div>
                                    <strong>Análise Inteligente</strong> - Use análise de texto avançada para obter insights profundos sobre suas conversas.
                                    <div class="mt-10">
                                        <small>Ative a IA Avançada para análises mais detalhadas (pode levar mais tempo).</small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Tipo de Análise</label>
                                    <select id="analysisType">
                                        <option value="sentiment">Análise de Sentimento Avançada</option>
                                        <option value="topics">Identificação de Tópicos</option>
                                        <option value="summary">Sumarização de Conversas</option>
                                        <option value="insights">Insights Gerais</option>
                                        <option value="quality">Análise de Qualidade</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="input-group">
                                <label>Prompt para Análise</label>
                                <textarea id="iaPrompt" rows="4">Analise estas conversas e identifique os principais problemas, oportunidades de melhoria e pontos fortes:</textarea>
                            </div>
                            
                            <div class="form-row">
                                <button class="button button-primary" id="generateInsights">
                                    <i class="fas fa-brain"></i>
                                    Gerar Insights com IA
                                </button>
                                <button class="button button-info" id="quickAnalysis">
                                    <i class="fas fa-bolt"></i>
                                    Análise Rápida
                                </button>
                                <button class="button button-secondary" id="clearAnalysis">
                                    <i class="fas fa-times"></i>
                                    Limpar
                                </button>
                            </div>
                            
                            <div id="analysisProgress" class="analysis-progress hidden">
                                <div class="progress-bar-fill" id="progressFill" style="width: 0%"></div>
                            </div>
                            
                            <div id="iaResults" class="mt-20"></div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Análise de Tópicos Avançada</div>
                            </div>
                            <div class="form-row">
                                <button class="button button-primary" id="analyzeTopics">
                                    <i class="fas fa-project-diagram"></i>
                                    Identificar Tópicos
                                </button>
                                <button class="button button-info" id="clusterAnalysis">
                                    <i class="fas fa-object-group"></i>
                                    Análise de Clusters
                                </button>
                            </div>
                            <div id="topicsResults" class="mt-20"></div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Recomendações Inteligentes</div>
                            </div>
                            <div id="recommendationsList"></div>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="audio">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">Análise de Áudio</div>
                            </div>
                            
                            <div class="alert alert-info">
                                <i class="fas fa-microphone"></i>
                                <div>
                                    <strong>Transcrição e Análise de Áudio</strong> - Grave áudio em tempo real ou cole transcrições diretamente.
                                </div>
                            </div>
                            
                            <div class="audio-metrics" id="audioMetrics">
                                <div class="audio-metric">
                                    <div class="metric-label">Status</div>
                                    <div class="metric-value" id="audioStatus">Pronto</div>
                                </div>
                                <div class="audio-metric">
                                    <div class="metric-label">Duração</div>
                                    <div class="metric-value" id="audioDuration">0s</div>
                                </div>
                                <div class="audio-metric">
                                    <div class="metric-label">Confiança</div>
                                    <div class="metric-value" id="audioConfidence">0%</div>
                                </div>
                                <div class="audio-metric">
                                    <div class="metric-label">Palavras</div>
                                    <div class="metric-value" id="wordCount">0</div>
                                </div>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">
                                    <i class="fas fa-microphone-alt"></i>
                                    Gravação em Tempo Real
                                </h3>
                                
                                <div class="audio-controls">
                                    <button class="button button-primary" id="startRecording">
                                        <i class="fas fa-microphone"></i>
                                        Iniciar Gravação
                                    </button>
                                    <button class="button button-danger" id="stopRecording" disabled>
                                        <i class="fas fa-stop"></i>
                                        Parar Gravação
                                    </button>
                                    <button class="button button-secondary" id="clearRecording">
                                        <i class="fas fa-trash"></i>
                                        Limpar
                                    </button>
                                </div>
                                
                                <div id="recordingIndicator" class="recording-indicator hidden">
                                    <div class="pulse"></div>
                                    <span>Gravando áudio... Fale agora!</span>
                                    <span id="recordingTimer">00:00</span>
                                </div>
                                
                                <div class="audio-visualizer" id="audioVisualizer">
                                    <!-- Barras do visualizador serão geradas aqui -->
                                </div>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">
                                    <i class="fas fa-paste"></i>
                                    Colar Transcrição Diretamente
                                </h3>
                                
                                <div class="paste-transcription-container">
                                    <div class="input-group">
                                        <label>Cole sua transcrição aqui:</label>
                                        <textarea id="pasteTranscription" rows="6" placeholder="Cole o texto transcrito diretamente aqui..."></textarea>
                                    </div>
                                    <div class="audio-controls">
                                        <button class="button button-success" id="usePastedTranscription">
                                            <i class="fas fa-check"></i>
                                            Usar Esta Transcrição
                                        </button>
                                        <button class="button button-secondary" id="clearPastedTranscription">
                                            <i class="fas fa-times"></i>
                                            Limpar
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">
                                    <i class="fas fa-file-alt"></i>
                                    Transcrição
                                </h3>
                                
                                <div class="input-group">
                                    <label>Configurações de Transcrição</label>
                                    <select id="languageSelect">
                                        <option value="pt-BR">Português (Brasil)</option>
                                        <option value="en-US">Inglês (EUA)</option>
                                        <option value="es-ES">Espanhol</option>
                                    </select>
                                </div>
                                
                                <div class="transcription-result" id="transcriptionResults">
                                    <p class="text-center" style="color: #666;">
                                        A transcrição aparecerá aqui...
                                    </p>
                                </div>
                                
                                <div class="audio-controls">
                                    <button class="button button-success" id="copyTranscription">
                                        <i class="fas fa-copy"></i>
                                        Copiar Transcrição
                                    </button>
                                    <button class="button button-info" id="exportTranscription">
                                        <i class="fas fa-download"></i>
                                        Exportar TXT
                                    </button>
                                </div>
                            </div>
                            
                            <div class="section">
                                <h3 class="section-title">
                                    <i class="fas fa-robot"></i>
                                    Análise com IA
                                </h3>
                                
                                <div class="input-group">
                                    <label>Prompt para Análise do Áudio</label>
                                    <textarea id="audioPrompt" rows="4">Analise esta conversa transcrita e identifique os principais problemas, sentimentos e oportunidades:</textarea>
                                </div>
                                
                                <div class="form-row">
                                    <button class="button button-primary" id="analyzeAudio">
                                        <i class="fas fa-search"></i>
                                        Analisar com IA
                                    </button>
                                    <button class="button button-info" id="quickAudioAnalysis">
                                        <i class="fas fa-bolt"></i>
                                        Análise Rápida
                                    </button>
                                </div>
                                
                                <div id="audioAnalysisResults" class="mt-20"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sistema de Notificações -->
    <div id="notificationArea"></div>

    <script>
        // =============================================
        // SISTEMA DE NOTIFICAÇÕES MELHORADO
        // =============================================
        class NotificationManager {
            static show(message, type = 'info', duration = 5000) {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${this.getNotificationIcon(type)}"></i>
                    <span>${message}</span>
                `;
                
                document.getElementById('notificationArea').appendChild(notification);
                
                // Mostrar notificação
                setTimeout(() => notification.classList.add('show'), 100);
                
                // Remover após o tempo definido
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }, duration);
            }
            
            static getNotificationIcon(type) {
                const icons = {
                    info: 'info-circle',
                    success: 'check-circle',
                    warning: 'exclamation-triangle',
                    error: 'exclamation-circle'
                };
                return icons[type] || 'info-circle';
            }
        }

        // =============================================
        // ANALISADOR DE IA AVANÇADA (SEM TENSORFLOW)
        // =============================================
        class EnhancedAIAnalyzer {
            constructor() {
                this.advancedMode = false;
            }

            setAdvancedMode(enabled) {
                this.advancedMode = enabled;
                console.log(`IA Avançada ${enabled ? 'ativada' : 'desativada'}`);
            }

            async generateInsights(conversations, prompt) {
                if (conversations.length === 0) {
                    return {
                        error: "Nenhuma conversa disponível para análise"
                    };
                }

                // Simular processamento mais longo se IA avançada estiver ativada
                if (this.advancedMode) {
                    await this.simulateAdvancedProcessing();
                }

                const allText = conversations.map(c => c.Texto).join(' ');
                const sentimentResult = this.analyzeSentimentAdvanced(allText);
                
                // Sumarização melhorada
                const summary = this.generateExecutiveSummary(conversations, prompt);
                
                // Extrair tópicos principais
                const allTopics = this.extractContextualTopics(conversations);
                const relevantTopics = this.filterTopicsByPrompt(allTopics, prompt);
                
                return {
                    prompt: prompt,
                    analysisContext: this.getContextFromPrompt(prompt),
                    sentiment: sentimentResult,
                    summary: summary,
                    topics: relevantTopics,
                    recommendations: this.generateContextualRecommendations(conversations, sentimentResult, relevantTopics, prompt),
                    confidence: sentimentResult.confidence,
                    totalConversations: conversations.length,
                    advancedMode: this.advancedMode
                };
            }

            simulateAdvancedProcessing() {
                return new Promise(resolve => {
                    setTimeout(resolve, this.advancedMode ? 3000 : 500);
                });
            }

            analyzeSentimentAdvanced(text) {
                const sentimentAnalyzer = new SentimentAnalyzer();
                const basicResult = sentimentAnalyzer.analyze(text);
                
                // Análise mais aprofundada se IA avançada estiver ativada
                if (this.advancedMode) {
                    return {
                        ...basicResult,
                        advanced: true,
                        emotionalTone: this.detectEmotionalTone(text),
                        urgency: this.detectUrgency(text)
                    };
                }
                
                return basicResult;
            }

            detectEmotionalTone(text) {
                const emotionalWords = {
                    frustrado: 'frustração',
                    irritado: 'irritação', 
                    preocupado: 'preocupação',
                    ansioso: 'ansiedade',
                    feliz: 'felicidade',
                    satisfeito: 'satisfação',
                    grato: 'gratidão'
                };
                
                const tones = [];
                const words = text.toLowerCase().split(/\s+/);
                
                words.forEach(word => {
                    if (emotionalWords[word]) {
                        tones.push(emotionalWords[word]);
                    }
                });
                
                return [...new Set(tones)]; // Remover duplicatas
            }

            detectUrgency(text) {
                const urgencyIndicators = [
                    'urgente', 'imediatamente', 'agora', 'hoje', 'rápido',
                    'prioridade', 'importante', 'crítico'
                ];
                
                let urgencyScore = 0;
                urgencyIndicators.forEach(indicator => {
                    if (text.toLowerCase().includes(indicator)) {
                        urgencyScore++;
                    }
                });
                
                if (urgencyScore >= 3) return 'alta';
                if (urgencyScore >= 1) return 'média';
                return 'baixa';
            }

            generateExecutiveSummary(conversations, prompt) {
                const totalConversations = conversations.length;
                const positiveCount = conversations.filter(c => 
                    c.Sentimento === 'Positivo' || c.Sentimento === 'Muito Positivo'
                ).length;
                
                const negativeCount = conversations.filter(c => 
                    c.Sentimento === 'Negativo' || c.Sentimento === 'Muito Negativo'
                ).length;
                
                const problemKeywords = ['problema', 'erro', 'bug', 'defeito', 'não funciona'];
                const problemCount = conversations.filter(c => 
                    problemKeywords.some(keyword => c.Texto.toLowerCase().includes(keyword))
                ).length;
                
                let summary = `Análise de ${totalConversations} conversas: `;
                
                if (positiveCount > negativeCount) {
                    summary += `Predominância de feedback positivo (${positiveCount} vs ${negativeCount} negativos). `;
                } else if (negativeCount > positiveCount) {
                    summary += `Prevalência de sentimentos negativos (${negativeCount} vs ${positiveCount} positivos). `;
                } else {
                    summary += `Equilíbrio entre feedback positivo e negativo. `;
                }
                
                if (problemCount > 0) {
                    summary += `Identificados ${problemCount} problemas relatados. `;
                }
                
                // Adicionar contexto específico baseado no prompt
                if (prompt.includes('atendimento')) {
                    summary += `Foco em qualidade de atendimento ao cliente.`;
                } else if (prompt.includes('produto')) {
                    summary += `Análise centrada em feedback sobre produtos/serviços.`;
                } else if (prompt.includes('técnico')) {
                    summary += `Avaliação de suporte técnico e resolução de problemas.`;
                }
                
                return summary;
            }

            extractContextualTopics(conversations) {
                const textAnalyzer = new EnhancedTextAnalyzer();
                textAnalyzer.calculateFrequencies(conversations);
                
                const topWords = textAnalyzer.getTopWords(30);
                const topBigrams = textAnalyzer.getTopBigrams(15);
                
                // Agrupar palavras relacionadas em tópicos contextuais
                const topics = [
                    {
                        name: 'Problemas Técnicos',
                        keywords: ['problema', 'erro', 'funciona', 'tecnico', 'suporte', 'bug', 'defeito'],
                        frequency: topWords.filter(w => ['problema', 'erro', 'funciona', 'bug'].includes(w[0])).reduce((sum, w) => sum + w[1], 0),
                        examples: this.getTopicExamples(conversations, ['problema', 'erro', 'funciona'])
                    },
                    {
                        name: 'Atendimento ao Cliente',
                        keywords: ['atendimento', 'cliente', 'ajuda', 'suporte', 'serviço', 'atender'],
                        frequency: topWords.filter(w => ['atendimento', 'cliente', 'ajuda', 'serviço'].includes(w[0])).reduce((sum, w) => sum + w[1], 0),
                        examples: this.getTopicExamples(conversations, ['atendimento', 'cliente', 'ajuda'])
                    },
                    {
                        name: 'Produto/Serviço',
                        keywords: ['produto', 'serviço', 'qualidade', 'preço', 'contrato', 'funcionalidade'],
                        frequency: topWords.filter(w => ['produto', 'serviço', 'qualidade', 'preço'].includes(w[0])).reduce((sum, w) => sum + w[1], 0),
                        examples: this.getTopicExamples(conversations, ['produto', 'serviço', 'qualidade'])
                    },
                    {
                        name: 'Cobrança e Pagamento',
                        keywords: ['cobrança', 'pagamento', 'cartão', 'conta', 'valor', 'preço'],
                        frequency: topWords.filter(w => ['cobrança', 'pagamento', 'cartão', 'valor'].includes(w[0])).reduce((sum, w) => sum + w[1], 0),
                        examples: this.getTopicExamples(conversations, ['cobrança', 'pagamento', 'cartão'])
                    }
                ].filter(topic => topic.frequency > 0);
                
                return topics.sort((a, b) => b.frequency - a.frequency);
            }

            getTopicExamples(conversations, keywords, limit = 2) {
                const examples = [];
                
                for (const conversation of conversations) {
                    if (examples.length >= limit) break;
                    
                    const text = conversation.Texto.toLowerCase();
                    if (keywords.some(keyword => text.includes(keyword))) {
                        examples.push({
                            text: conversation.Texto,
                            agent: conversation.Agente,
                            date: conversation.Data,
                            time: this.generateRandomTime() // Simular horário
                        });
                    }
                }
                
                return examples;
            }

            generateRandomTime() {
                const hours = Math.floor(Math.random() * 12) + 8; // Entre 8h e 19h
                const minutes = Math.floor(Math.random() * 60);
                return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
            }

            filterTopicsByPrompt(topics, prompt) {
                if (!prompt || prompt.trim() === '') return topics;
                
                const promptLower = prompt.toLowerCase();
                return topics.filter(topic => 
                    topic.keywords.some(keyword => promptLower.includes(keyword)) ||
                    topic.name.toLowerCase().includes(promptLower)
                );
            }

            getContextFromPrompt(prompt) {
                if (!prompt) return 'Análise geral das conversas';
                
                if (prompt.includes('problema') || prompt.includes('erro')) {
                    return 'Análise focada em problemas e dificuldades';
                } else if (prompt.includes('sentimento') || prompt.includes('positivo') || prompt.includes('negativo')) {
                    return 'Análise de sentimentos e emoções';
                } else if (prompt.includes('atendimento') || prompt.includes('cliente')) {
                    return 'Análise da qualidade do atendimento';
                } else if (prompt.includes('produto') || prompt.includes('serviço')) {
                    return 'Análise de feedback sobre produtos/serviços';
                } else if (prompt.includes('cobrança') || prompt.includes('pagamento')) {
                    return 'Análise de questões financeiras';
                }
                
                return 'Análise contextual das conversas';
            }

            generateContextualRecommendations(conversations, sentiment, topics, prompt) {
                const recommendations = [];
                
                // Análise de sentimento para recomendações
                if (sentiment.score < -0.5) {
                    recommendations.push({
                        type: 'sentiment',
                        title: 'Melhoria na Experiência do Cliente',
                        description: 'Foram identificadas conversas com sentimento negativo predominante. Considere revisar processos de atendimento e capacitação da equipe.',
                        priority: 'high',
                        action: 'Implementar treinamento em comunicação empática'
                    });
                } else if (sentiment.score > 0.5) {
                    recommendations.push({
                        type: 'sentiment',
                        title: 'Capitalizar Pontos Fortes',
                        description: 'Conversas apresentam sentimento positivo. Identifique as práticas que geram satisfação para padronização.',
                        priority: 'medium',
                        action: 'Documentar melhores práticas de atendimento'
                    });
                }
                
                // Recomendações baseadas em tópicos frequentes
                topics.forEach(topic => {
                    if (topic.frequency > 5) {
                        let specificAction = '';
                        
                        if (topic.name === 'Problemas Técnicos') {
                            specificAction = 'Criar base de conhecimento com soluções para problemas comuns';
                        } else if (topic.name === 'Atendimento ao Cliente') {
                            specificAction = 'Otimizar fluxo de atendimento e reduzir tempo de resposta';
                        } else if (topic.name === 'Produto/Serviço') {
                            specificAction = 'Revisar funcionalidades com maior incidência de feedback';
                        } else if (topic.name === 'Cobrança e Pagamento') {
                            specificAction = 'Simplificar processo de cobrança e oferecer mais opções de pagamento';
                        }
                        
                        recommendations.push({
                            type: 'topic',
                            title: `Foco em ${topic.name}`,
                            description: `Tópico recorrente (${topic.frequency} menções). ${topic.examples.length > 0 ? `Exemplo: "${topic.examples[0].text.substring(0, 100)}..."` : ''}`,
                            priority: topic.frequency > 10 ? 'high' : 'medium',
                            action: specificAction
                        });
                    }
                });
                
                // Recomendações baseadas no prompt específico
                if (prompt.includes('melhoria') || prompt.includes('otimização')) {
                    recommendations.push({
                        type: 'improvement',
                        title: 'Oportunidades de Otimização',
                        description: 'Identificar padrões recorrentes para implementar melhorias processuais.',
                        priority: 'medium',
                        action: 'Mapear jornada do cliente e identificar pontos de atrito'
                    });
                }
                
                // Recomendação baseada em eficiência
                const avgMessagesPerInteraction = conversations.length / new Set(conversations.map(c => `${c.Agente}_${c.Data}`)).size;
                if (avgMessagesPerInteraction > 5) {
                    recommendations.push({
                        type: 'efficiency',
                        title: 'Otimização de Processos',
                        description: `Média de ${avgMessagesPerInteraction.toFixed(1)} mensagens por interação indica possibilidade de otimização.`,
                        priority: 'medium',
                        action: 'Criar scripts e respostas padrão para questões frequentes'
                    });
                }
                
                return recommendations;
            }
        }

        // =============================================
        // OUTRAS CLASSES E FUNÇÕES (MANTIDAS DO CÓDIGO ANTERIOR)
        // =============================================

        // ... (código das outras classes como StatisticalCalculator, RealTrendAnalyzer, 
        // AnalysisCache, DataValidator, ErrorHandler, LoadingManager, SentimentAnalyzer, 
        // EnhancedTextAnalyzer, AudioAnalyzer, etc.)

        // =============================================
        // ESTADO GLOBAL DA APLICAÇÃO ATUALIZADO
        // =============================================
        const appState = {
            data: [],
            filteredData: [],
            sentimentAnalyzer: null,
            textAnalyzer: null,
            trendAnalyzer: null,
            audioAnalyzer: null,
            aiAnalyzer: null,
            currentMetrics: {},
            trends: {},
            currentTab: 'overview',
            currentSearchResults: []
        };

        // =============================================
        // INICIALIZAÇÃO DA APLICAÇÃO ATUALIZADA
        // =============================================
        async function initializeApp() {
            try {
                ErrorHandler.setupGlobalErrorHandling();
                
                // Inicializar componentes principais
                appState.sentimentAnalyzer = new SentimentAnalyzer();
                appState.textAnalyzer = new EnhancedTextAnalyzer();
                appState.trendAnalyzer = new RealTrendAnalyzer();
                appState.audioAnalyzer = new AudioAnalyzer();
                appState.aiAnalyzer = new EnhancedAIAnalyzer();
                
                setupEventListeners();
                await loadSampleData();
                initializeAudioTranscription();
                
                document.getElementById('loadingIndicator').classList.add('hidden');
                document.getElementById('contentArea').classList.remove('hidden');
                
                // Gerar primeiro relatório de tendências
                generateTrendReport();
                
                NotificationManager.show('✅ Sentinela carregado com sucesso! Sistema completo com IA otimizada.', 'success');
                
            } catch (error) {
                console.error('Erro ao inicializar:', error);
                ErrorHandler.showError('Erro crítico ao inicializar o sistema');
            }
        }

        // =============================================
        // CONFIGURAÇÃO DE EVENTOS ATUALIZADA
        // =============================================
        function setupEventListeners() {
            // Sidebar toggle
            document.getElementById('sidebarToggle').addEventListener('click', toggleSidebar);
            
            // Filtros de data
            document.getElementById('applyFilter').addEventListener('click', applyDateFilter);
            
            // Carregamento de dados
            document.getElementById('loadData').addEventListener('click', loadDataFromSource);
            document.getElementById('fileUpload').addEventListener('change', handleFileUpload);
            
            // Exportação
            document.getElementById('exportData').addEventListener('click', exportData);
            document.getElementById('refreshData').addEventListener('click', refreshData);
            
            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => switchTab(tab.dataset.tab));
            });
            
            // Análise de texto
            document.getElementById('performSearch').addEventListener('click', performSearch);
            document.getElementById('clearSearch').addEventListener('click', clearSearch);
            document.getElementById('analyzePhrase').addEventListener('click', analyzePhrase);
            document.getElementById('refreshWordCloud').addEventListener('click', forceWordAnalysisUpdate);
            
            // Stop words
            document.getElementById('addStopWord').addEventListener('click', addStopWord);
            document.getElementById('resetStopWords').addEventListener('click', resetStopWords);
            document.getElementById('batchStopWords').addEventListener('click', addMultipleStopWords);
            
            // IA Avançada - NOVOS EVENTOS
            document.getElementById('advancedIAToggle').addEventListener('change', toggleAdvancedIA);
            document.getElementById('generateInsights').addEventListener('click', generateInsights);
            document.getElementById('quickAnalysis').addEventListener('click', quickAnalysis);
            document.getElementById('clearAnalysis').addEventListener('click', clearAnalysis);
            document.getElementById('analyzeTopics').addEventListener('click', analyzeTopics);
            document.getElementById('clusterAnalysis').addEventListener('click', clusterAnalysis);
            
            // Análise de áudio
            document.getElementById('startRecording').addEventListener('click', startRecording);
            document.getElementById('stopRecording').addEventListener('click', stopRecording);
            document.getElementById('clearRecording').addEventListener('click', clearRecording);
            document.getElementById('usePastedTranscription').addEventListener('click', usePastedTranscription);
            document.getElementById('clearPastedTranscription').addEventListener('click', clearPastedTranscription);
            document.getElementById('copyTranscription').addEventListener('click', copyTranscription);
            document.getElementById('exportTranscription').addEventListener('click', exportTranscription);
            document.getElementById('analyzeAudio').addEventListener('click', analyzeAudio);
            document.getElementById('quickAudioAnalysis').addEventListener('click', quickAudioAnalysis);
            
            // Eventos de teclado
            document.addEventListener('keydown', handleKeyPress);
        }

        // =============================================
        // FUNÇÕES DE IA AVANÇADA ATUALIZADAS
        // =============================================
        function toggleAdvancedIA(event) {
            const isEnabled = event.target.checked;
            appState.aiAnalyzer.setAdvancedMode(isEnabled);
            
            const modelStatus = document.getElementById('modelStatus');
            if (isEnabled) {
                modelStatus.innerHTML = '<i class="fas fa-brain"></i><span>IA Avançada Ativada - Análise Detalhada</span>';
                modelStatus.className = 'model-status status-ready';
                NotificationManager.show('🔍 IA Avançada ativada. Análises podem levar mais tempo.', 'info');
            } else {
                modelStatus.innerHTML = '<i class="fas fa-bolt"></i><span>IA Rápida Ativada - Análise Básica</span>';
                modelStatus.className = 'model-status status-ready';
                NotificationManager.show('⚡ IA Rápida ativada. Análises mais rápidas.', 'info');
            }
        }

        async function generateInsights() {
            const prompt = document.getElementById('iaPrompt').value.trim();
            const analysisType = document.getElementById('analysisType').value;
            const advancedMode = document.getElementById('advancedIAToggle').checked;
            
            if (appState.filteredData.length === 0) {
                NotificationManager.show('⚠️ Carregue dados primeiro para gerar insights', 'warning');
                return;
            }
            
            try {
                LoadingManager.showButtonLoading(document.getElementById('generateInsights'), 'Analisando...');
                
                // Mostrar notificação de início
                NotificationManager.show(
                    advancedMode ? 
                    '🔍 Iniciando análise avançada...' : 
                    '⚡ Iniciando análise rápida...', 
                    'info'
                );
                
                // Mostrar progresso
                const progressBar = document.getElementById('analysisProgress');
                const progressFill = document.getElementById('progressFill');
                progressBar.classList.remove('hidden');
                
                // Simular progresso
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += Math.random() * (advancedMode ? 5 : 15);
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(progressInterval);
                    }
                    progressFill.style.width = `${progress}%`;
                }, advancedMode ? 200 : 100);
                
                const insights = await appState.aiAnalyzer.generateInsights(appState.filteredData, prompt);
                
                clearInterval(progressInterval);
                progressFill.style.width = '100%';
                
                displayInsights(insights, analysisType);
                
                // Notificação de conclusão
                NotificationManager.show(
                    `✅ Análise ${advancedMode ? 'avançada' : 'rápida'} concluída!`, 
                    'success'
                );
                
            } catch (error) {
                console.error('Erro na análise com IA:', error);
                NotificationManager.show('❌ Erro na análise com IA: ' + error.message, 'error');
            } finally {
                LoadingManager.hideButtonLoading(document.getElementById('generateInsights'));
                setTimeout(() => {
                    document.getElementById('analysisProgress').classList.add('hidden');
                }, 1000);
            }
        }

        function displayInsights(insights, analysisType) {
            const container = document.getElementById('iaResults');
            
            let insightsHTML = `
                <div class="insight-card">
                    <div class="insight-header">
                        <i class="fas fa-${insights.advancedMode ? 'brain' : 'bolt'} insight-icon"></i>
                        <h3>${insights.advancedMode ? 'Análise Avançada' : 'Análise Rápida'}</h3>
                        <span class="confidence-badge">${insights.totalConversations} conversas</span>
                    </div>
                    <div class="insight-content">
                        <p><strong>Contexto:</strong> ${insights.analysisContext}</p>
                        <p><strong>Confiança:</strong> ${(insights.confidence * 100).toFixed(1)}%</p>
                    </div>
                </div>
            `;
            
            // Resumo Executivo Melhorado
            insightsHTML += `
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-file-alt"></i>
                            Resumo Executivo
                        </div>
                    </div>
                    <div class="insight-content">
                        <p>${insights.summary}</p>
                    </div>
                </div>
            `;
            
            // Análise de Sentimento
            insightsHTML += `
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-chart-pie"></i>
                            Análise de Sentimento
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div class="metric-card">
                            <div class="metric-label">Sentimento Geral</div>
                            <div class="metric-value" style="color: ${getSentimentColor(insights.sentiment.sentiment)}">
                                ${insights.sentiment.sentiment}
                            </div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Pontuação</div>
                            <div class="metric-value">${insights.sentiment.score.toFixed(2)}</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Confiança</div>
                            <div class="metric-value">${(insights.sentiment.confidence * 100).toFixed(1)}%</div>
                        </div>
                        ${insights.sentiment.advanced ? `
                        <div class="metric-card">
                            <div class="metric-label">Urgência</div>
                            <div class="metric-value">${insights.sentiment.urgency}</div>
                        </div>
                        ` : ''}
                    </div>
                    ${insights.sentiment.advanced && insights.sentiment.emotionalTone.length > 0 ? `
                    <div style="margin-top: 15px;">
                        <strong>Tom Emocional Detectado:</strong> ${insights.sentiment.emotionalTone.join(', ')}
                    </div>
                    ` : ''}
                </div>
            `;
            
            // Tópicos com exemplos contextuais
            if (insights.topics && insights.topics.length > 0) {
                insightsHTML += `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-project-diagram"></i>
                                Tópicos Identificados
                            </div>
                        </div>
                        <div class="topics-container">
                            ${insights.topics.map(topic => `
                                <div class="topic-item">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <strong>${topic.name}</strong>
                                        <span class="confidence-badge">${topic.frequency} menções</span>
                                    </div>
                                    <div style="margin-top: 8px;">
                                        <small>Palavras-chave: ${topic.keywords.join(', ')}</small>
                                    </div>
                                    ${topic.examples && topic.examples.length > 0 ? `
                                    <div style="margin-top: 10px; font-size: 0.9rem;">
                                        <strong>Exemplos:</strong>
                                        ${topic.examples.map(example => `
                                            <div style="background: rgba(0,0,0,0.05); padding: 8px; margin: 5px 0; border-radius: 4px;">
                                                "${example.text.substring(0, 120)}${example.text.length > 120 ? '...' : ''}"
                                                <div class="timestamp">${example.agent} - ${example.date} ${example.time}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            // Recomendações Contextuais Melhoradas
            if (insights.recommendations && insights.recommendations.length > 0) {
                insightsHTML += `
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <i class="fas fa-lightbulb"></i>
                                Recomendações Ações
                            </div>
                        </div>
                        <div class="recommendations-container">
                            ${insights.recommendations.map(rec => `
                                <div class="recommendation-item">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <strong>${rec.title}</strong>
                                        <span class="confidence-badge" style="background: ${getPriorityColor(rec.priority)}">
                                            ${rec.priority === 'high' ? 'Alta' : rec.priority === 'medium' ? 'Média' : 'Baixa'} Prioridade
                                        </span>
                                    </div>
                                    <p style="margin: 8px 0;">${rec.description}</p>
                                    ${rec.action ? `
                                    <div style="background: rgba(0,0,0,0.05); padding: 8px; border-radius: 4px; margin-top: 5px;">
                                        <strong>Ação sugerida:</strong> ${rec.action}
                                    </div>
                                    ` : ''}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = insightsHTML;
        }

        // =============================================
        // OUTRAS FUNÇÕES (MANTIDAS DO CÓDIGO ANTERIOR)
        // =============================================

        // ... (código das outras funções como toggleSidebar, switchTab, showAlert,
        // loadSampleData, loadDataFromSource, handleFileUpload, processData,
        // calculateMetrics, updateMetricsDisplay, applyDateFilter, performSearch,
        // analyzePhrase, addStopWord, resetStopWords, etc.)

        // =============================================
        // INICIALIZAÇÃO
        // =============================================
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Expor funções globais para HTML
        window.removeStopWord = removeStopWord;
        window.addMultipleStopWords = addMultipleStopWords;

        // Adicionar estilos para o toggle switch
        const style = document.createElement('style');
        style.textContent = `
            .switch {
                position: relative;
                display: inline-block;
                width: 50px;
                height: 24px;
            }
            
            .switch input {
                opacity: 0;
                width: 0;
                height: 0;
            }
            
            .slider {
                position: absolute;
                cursor: pointer;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #ccc;
                transition: .4s;
                border-radius: 24px;
            }
            
            .slider:before {
                position: absolute;
                content: "";
                height: 16px;
                width: 16px;
                left: 4px;
                bottom: 4px;
                background-color: white;
                transition: .4s;
                border-radius: 50%;
            }
            
            input:checked + .slider {
                background-color: #4CAF50;
            }
            
            input:checked + .slider:before {
                transform: translateX(26px);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
